- name: Install GitHub Desktop, VS Code, and Trae IDE
      shell: powershell
      run: |
        function Install-App {
          param (
            [string]$Name,
            [string]$Url,
            [string]$Output,
            [string]$Args
          )
          Write-Host "Downloading $Name..."
          Invoke-WebRequest -Uri $Url -OutFile $Output
          Write-Host "Installing $Name..."
          Start-Process -FilePath $Output -ArgumentList $Args -NoNewWindow -Wait
          Write-Host "$Name installation finished."
        }

        # GitHub Desktop
        Install-App -Name "GitHub Desktop" `
          -Url "https://central.github.com/deployments/desktop/desktop/latest/win32" `
          -Output "$env:TEMP\GitHubDesktopSetup.msi" `
          -Args "/i `"$env:TEMP\GitHubDesktopSetup.msi`" /quiet /norestart"

        # VS Code
        Install-App -Name "VS Code" `
          -Url "https://code.visualstudio.com/sha/download?build=stable&os=win32-x64-user" `
          -Output "$env:TEMP\vscode_setup.exe" `
          -Args "/silent"

        # Trae IDE
        Install-App -Name "Trae IDE" `
          -Url "https://lf-trae.toscdn.com/obj/trae-ai-cn/pkg/app/releases/stable/1.0.10283/win32/Trae-Setup-x64.exe" `
          -Output "$env:TEMP\TraeSetup.exe" `
          -Args "/S"
